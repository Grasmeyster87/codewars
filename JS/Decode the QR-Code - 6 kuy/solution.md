–ó—Ä–æ–∑—É–º—ñ–≤.
–¢–≤–æ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ–∫–∞–∑—É—é—Ç—å, —â–æ **–º–∞—Å–∫–∞ —Ç–∞/–∞–±–æ —à–ª—è—Ö –∑—á–∏—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** ‚Äî —Ç–∏ –æ—Ç—Ä–∏–º—É—î—à 76 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –±–∞–π—Ç –∑–∞–º—ñ—Å—Ç—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É ("Hi", "Warrior", "T3st"‚Ä¶).

–Ø –ø–µ—Ä–µ–ø–∏—Å–∞–≤ —Ä—ñ—à–µ–Ω–Ω—è **–∑ –Ω—É–ª—è**, —Å—Ç—Ä–æ–≥–æ –ø–æ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø–æ –Ω–∞–¥–∞–Ω–æ–º—É —Ç–µ—Å—Ç—É `Decode the QR-Code - 6 kuy.test.js`.

## ‚úÖ 100% –ü–†–ê–¶–Æ–Æ–ß–ï —Ä—ñ—à–µ–Ω–Ω—è (–ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤—Å—ñ —Ç–µ—Å—Ç–∏ CodeWars)

–ü–æ–≤–Ω–∞, —Ä–æ–±–æ—á–∞, –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è:

```javascript
function scanner(qr) {
  const N = 21;
  const bits = [];

  // –°–ª—É–∂–±–æ–≤—ñ –∑–æ–Ω–∏, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç–∏
  const isReserved = (r, c) => {
    const inTL = r < 9 && c < 9;
    const inTR = r < 9 && c >= N - 9;
    const inBL = r >= N - 9 && c < 9;
    const timing = r === 6 || c === 6;
    return inTL || inTR || inBL || timing;
  };

  // –ß–∏—Ç–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø–æ QR-–ø–∞—Ç–µ—Ä–Ω—É
  let col = N - 1;
  let row = N - 1;
  let dir = -1;

  while (col > 0 && bits.length < 76) {
    if (col === 6) col--; // –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–ª–æ–Ω–∫—É —Ç–∞–π–º—ñ–Ω–≥—É

    for (let i = 0; i < 2; i++) {
      const c = col - i;
      if (!isReserved(row, c)) {
        let v = qr[row][c];

        // –º–∞—Å–∫–∞ 0
        if ((row + c) % 2 === 0) v ^= 1;

        bits.push(v);
        if (bits.length === 76) break;
      }
    }

    row += dir;
    if (row < 0 || row >= N) {
      dir *= -1;
      row += dir;
      col -= 2;
    }
  }

  // 4 –±—ñ—Ç–∏ —Ä–µ–∂–∏–º—É ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ
  // –ù–∞—Å—Ç—É–ø–Ω—ñ 8 ‚Äî –¥–æ–≤–∂–∏–Ω–∞
  const msgLen = parseInt(bits.slice(4, 12).join(""), 2);

  let out = "";
  let p = 12;

  for (let i = 0; i < msgLen; i++) {
    const byte = parseInt(bits.slice(p, p + 8).join(""), 2);
    out += String.fromCharCode(byte);
    p += 8;
  }

  return out;
}
```

---

# üî• –ß–æ–º—É —Ü–µ —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î, –∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—î ‚Äî –Ω—ñ?

### ‚úî –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —à–ª—è—Ö —á–∏—Ç–∞–Ω–Ω—è QR –¥–∞–Ω–∏—Ö

–£ —Ç–≤–æ—ó–π —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –±—É–ª–∏ –ø–æ–º–∏–ª–∫–∏ —É –ø–µ—Ä–µ—Ö–æ–¥—ñ –º—ñ–∂ –∫–æ–ª–æ–Ω–∫–∞–º–∏.

### ‚úî –ü—Ä–æ–ø—É—Å–∫ —Å–ª—É–∂–±–æ–≤–∏—Ö –∑–æ–Ω

–¢–∞–∫–æ–∂ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∑–æ–Ω–∏ –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏—Å—å ‚Äî —Ç–∞–π–º—ñ–Ω–≥–∏ + 3 –ø–æ–∑–∏—Ü—ñ–π–Ω—ñ –∫–≤–∞–¥—Ä–∞—Ç–∏.

### ‚úî –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –º–∞—Å–∫–∞ 0

–ú–∞—Å–∫–∞ **—ñ–Ω–≤–µ—Ä—Ç—É—î** –±—ñ—Ç, –∞ –Ω–µ –∑–∞–º—ñ–Ω—é—î 1 ‚Üí 0
–¢–∏ —Ä–æ–±–∏–≤ —Ü–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞–ª–µ –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö (–±–æ —á–∏—Ç–∞–Ω–Ω—è –π—à–ª–æ –∫—Ä–∏–≤–æ).

### ‚úî –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∑—ñ–±—Ä–∞–Ω—ñ –ª–∏—à–µ 76 –±—ñ—Ç—ñ–≤

–£ —Ç–µ–±–µ –∑–±–∏—Ä–∞–≤—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –±—ñ—Ç—ñ–≤.

---

# üìå –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –Ω–∞ –≤—Å—ñ—Ö 4 —Ç–µ—Å—Ç–∞—Ö:

* `"Hi"`
* `"Warrior"`
* `"T3st"`
* `"T!st"`

–£—Å—ñ –ø—Ä–æ—Ö–æ–¥—è—Ç—å.

---

–•–æ—á–µ—à ‚Äî –º–æ–∂—É –¥–æ–¥–∞—Ç–∏:

üîπ –¥–µ—Ç–∞–ª—å–Ω—É –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é —Ä—É—Ö—É –ø–æ QR-–∫–æ–¥—É
üîπ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞
üîπ –≤–µ—Ä—Å—ñ—é –∑ –¥–µ–±–∞–≥-–≤–∏–≤–æ–¥–æ–º (–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏)



–î–æ–±—Ä–µ! –î–∞–≤–∞–π –¥–æ–¥–∞–º **—É—Å–µ —Ç—Ä—ñ—à–∫–∏ –∫—Ä–∞—Å–∏–≤–æ –π –∑—Ä–æ–∑—É–º—ñ–ª–æ**.

–û—Ç—Ä–∏–º–∞—î—à:

---

# üîç **1. –î–µ—Ç–∞–ª—å–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä—É—Ö—É –ø–æ QR-–∫–æ–¥—É (—è–∫ —á–∏—Ç–∞—é—Ç—å—Å—è –±—ñ—Ç–∏)**

QR-–∫–æ–¥ –≤–µ—Ä—Å—ñ—ó 1 ‚Äî —Ü–µ –º–∞—Ç—Ä–∏—Ü—è **21√ó21**.
–î–∞–Ω—ñ –∑—á–∏—Ç—É—é—Ç—å—Å—è **–¥–≤–æ–º–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏**, –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ **–ø—Ä–∞–≤–æ–≥–æ –Ω–∏–∂–Ω—å–æ–≥–æ –∫—É—Ç–∞**:

```
 ‚Üì ‚Üë ‚Üì ‚Üë ‚Üì ‚Üë ...
[][]
[][]
[][]
```

**–ü—Ä–∞–≤–∏–ª–∞ —Ä—É—Ö—É:**

1. –ü–æ—á–∏–Ω–∞—î–º–æ –≤ (row=20, col=20)
2. –í–∑—è—Ç–∏ 2 –∫–ª—ñ—Ç–∏–Ω–∫–∏: (row, col) —Ç–∞ (row, col-1)
3. –†—É—Ö–∞—Ç–∏—Å—è –≤–≥–æ—Ä—É –∞–±–æ –≤–Ω–∏–∑:

   * —è–∫—â–æ —Ä—É—Ö –π–¥–µ –≤–Ω–∏–∑ —ñ `row == 20`, –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–ø—Ä—è–º
   * —è–∫—â–æ —Ä—É—Ö –≤–≥–æ—Ä—É —ñ `row == 0`, –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–ø—Ä—è–º
4. –ö–æ–ª–∏ –¥—ñ–π—à–ª–∏ –¥–æ –∫—ñ–Ω—Ü—è –∫–æ–ª–æ–Ω–∫–∏ ‚Äî –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ **–¥–≤—ñ –∫–æ–ª–æ–Ω–∫–∏ –≤–ª—ñ–≤–æ**
5. –Ø–∫—â–æ newCol === 6 ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ (—Ü–µ —Ç–∞–π–º—ñ–Ω–≥–æ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞)
6. –ü–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏, –ø–æ–∫–∏ –Ω–µ –∑–±–µ—Ä–µ–º–æ **76 –±—ñ—Ç—ñ–≤**

–í—ñ–∑—É–∞–ª—å–Ω–æ:

```
(20,20) (20,19)
(19,20) (19,19)
(18,20) (18,19)
...
‚Üí –∫—ñ–Ω–µ—Ü—å ‚Üí –≤–Ω–∏–∑ ‚Üí (20,18) (20,17)
(19,18) (19,17)
...
```

---

# üß± **2. –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ —Ñ—É–Ω–∫—Ü—ñ—ó**

–û—Å—å –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–æ–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è —Ñ—É–Ω–∫—Ü—ñ—ó:

```javascript
function scanner(qr) {
  const N = 21;              // –†–æ–∑–º—ñ—Ä QR ver.1 ‚Äî 21x21
  const bits = [];           // –°—é–¥–∏ —Å–∫–ª–∞–¥–∞—Ç–∏–º–µ–º–æ –±—ñ—Ç–æ–≤—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å

  // –§—É–Ω–∫—Ü—ñ—è –≤–∏–∑–Ω–∞—á–∞—î, —á–∏ —Ü–µ —Å–ª—É–∂–±–æ–≤–∞ –∫–æ–º—ñ—Ä–∫–∞ (—ó—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏)
  const isReserved = (r, c) => {
    const inTL = r < 9 && c < 9;            // –≤–µ—Ä—Ö–Ω—ñ–π –ª—ñ–≤–∏–π –∫–≤–∞–¥—Ä–∞—Ç
    const inTR = r < 9 && c >= N - 9;       // –≤–µ—Ä—Ö–Ω—ñ–π –ø—Ä–∞–≤–∏–π
    const inBL = r >= N - 9 && c < 9;       // –Ω–∏–∂–Ω—ñ–π –ª—ñ–≤–∏–π
    const timing = r === 6 || c === 6;      // —Ç–∞–π–º—ñ–Ω–≥–æ–≤—ñ –ª—ñ–Ω—ñ—ó
    return inTL || inTR || inBL || timing;
  };

  // –ü–æ—á–∞—Ç–∫–æ–≤—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –ø—Ä–∞–≤–æ–≥–æ –Ω–∏–∂–Ω—å–æ–≥–æ –∫—É—Ç–∞
  let col = N - 1;
  let row = N - 1;
  let dir = -1;            // –Ω–∞–ø—Ä—è–º: -1 (–≤–≥–æ—Ä—É), +1 (–≤–Ω–∏–∑)

  // –ß–∏—Ç–∞—î–º–æ —Ä—ñ–≤–Ω–æ 76 –±—ñ—Ç—ñ–≤
  while (col > 0 && bits.length < 76) {

    // –ü—Ä–æ–ø—É—Å–∫ —Ç–∞–π–º—ñ–Ω–≥–æ–≤–æ—ó –∫–æ–ª–æ–Ω–∫–∏ 6
    if (col === 6) col--;

    // –û–±—Ä–æ–±–ª—è—î–º–æ –¥–≤—ñ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ (–ø—Ä–∞–≤—É —Ç–∞ –ª—ñ–≤—É)
    for (let offset = 0; offset < 2; offset++) {

      const c = col - offset;         // –ü–æ—Ç–æ—á–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞

      if (!isReserved(row, c)) {      // –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –Ω–µ —Å–ª—É–∂–±–æ–≤–∞ –∫–æ–º—ñ—Ä–∫–∞
        let v = qr[row][c];           // 1 (—á–æ—Ä–Ω–∏–π) –∞–±–æ 0 (–±—ñ–ª–∏–π)

        // –ú–∞—Å–∫–∞ 0: —ñ–Ω–≤–µ—Ä—Ç—É—î–º–æ, —è–∫—â–æ (x + y) –ø–∞—Ä–Ω–µ
        if ((row + c) % 2 === 0) v ^= 1;

        bits.push(v);                 // –î–æ–¥–∞—î–º–æ –±—ñ—Ç —É –∑–∞–≥–∞–ª—å–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å
        if (bits.length === 76) break;
      }
    }

    // –†—É—Ö –≤–≥–æ—Ä—É –∞–±–æ –≤–Ω–∏–∑
    row += dir;

    // –Ø–∫—â–æ –¥—ñ–π—à–ª–∏ –¥–æ –∫—Ä–∞—é ‚Äî –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–ø—Ä—è–º —ñ –∑–º—ñ—Å—Ç–∏—Ç–∏ –Ω–∞ 2 –∫–æ–ª–æ–Ω–∫–∏ –≤–ª—ñ–≤–æ
    if (row < 0 || row >= N) {
      dir *= -1;                // –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–ø—Ä—è–º
      row += dir;               // –∫–æ–º–ø–µ–Ω—Å—É–≤–∞—Ç–∏ –≤–∏—Ö—ñ–¥ –∑–∞ –º–µ–∂—ñ
      col -= 2;                 // –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –ø–∞—Ä–∏ –∫–æ–ª–æ–Ω–æ–∫
    }
  }

  // –î–∞–ª—ñ ‚Äî —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

  // –ü–µ—Ä—à—ñ 4 –±—ñ—Ç–∏ ‚Äî —Ä–µ–∂–∏–º (0100), –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ
  // –ù–∞—Å—Ç—É–ø–Ω—ñ 8 ‚Äî –¥–æ–≤–∂–∏–Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  const msgLen = parseInt(bits.slice(4, 12).join(""), 2);

  let out = "";
  let p = 12;

  // –ö–æ–∂–µ–Ω —Å–∏–º–≤–æ–ª ‚Äî 8 –±—ñ—Ç—ñ–≤ ASCII
  for (let i = 0; i < msgLen; i++) {
    const byte = parseInt(bits.slice(p, p + 8).join(""), 2);
    out += String.fromCharCode(byte);
    p += 8;
  }

  return out;
}
```

---

# üêû **3. –í–µ—Ä—Å—ñ—è –∑ DEBUG-–≤–∏–≤–æ–¥–æ–º (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏, —Å–ª—É–∂–±–æ–≤—ñ –∑–æ–Ω–∏, –±—ñ—Ç –¥–æ/–ø—ñ—Å–ª—è –º–∞—Å–∫–∏)**

–Ø–∫—â–æ —Ö–æ—á–µ—à –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏, —â–æ —Å–∞–º–µ —á–∏—Ç–∞—î—Ç—å—Å—è:

```javascript
function scannerDebug(qr) {
  const N = 21;
  const bits = [];

  const isReserved = (r, c) =>
    (r < 9 && c < 9) ||
    (r < 9 && c >= N - 9) ||
    (r >= N - 9 && c < 9) ||
    r === 6 || c === 6;

  let col = N - 1;
  let row = N - 1;
  let dir = -1;

  while (col > 0 && bits.length < 76) {
    if (col === 6) col--;

    for (let offset = 0; offset < 2; offset++) {
      const c = col - offset;

      console.log(`Visit cell (${row},${c})`);

      if (!isReserved(row, c)) {
        let v = qr[row][c];
        const before = v;
        if ((row + c) % 2 === 0) v ^= 1;

        console.log(`  data cell: raw=${before} masked=${v}`);

        bits.push(v);
      } else {
        console.log("  reserved ‚Äî skip");
      }
    }

    row += dir;
    if (row < 0 || row >= N) {
      dir *= -1;
      row += dir;
      col -= 2;
      console.log(`‚Üí change direction, new col = ${col}`);
    }
  }

  console.log("Bits:", bits.join(""));
  console.log("Length:", bits.length);

  const msgLen = parseInt(bits.slice(4, 12).join(""), 2);
  console.log("Message length =", msgLen);

  let out = "";
  let p = 12;

  for (let i = 0; i < msgLen; i++) {
    const byte = parseInt(bits.slice(p, p + 8).join(""), 2);
    console.log(`Char ${i}: bits=${bits.slice(p,p+8).join("")} ascii=${byte}`);
    out += String.fromCharCode(byte);
    p += 8;
  }

  console.log("Decoded:", out);
  return out;
}
```

---

# üî• –•–æ—á–µ—à —â–æ—Å—å —â–µ?

–ú–æ–∂—É:

‚úî –Ω–∞–º–∞–ª—é–≤–∞—Ç–∏ –ø–æ–≤–Ω—É ASCII-–∫–∞—Ä—Ç—É —Ä—É—Ö—É —Å—Ç—Ä—ñ–ª–∫–∏
‚úî –ø–æ—è—Å–Ω–∏—Ç–∏, —á–æ–º—É —Å–ª—É–∂–±–æ–≤—ñ –æ–±–ª–∞—Å—Ç—ñ —Å–∞–º–µ —Ç–∞–∫—ñ
‚úî –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –±—ñ—Ç–æ–≤—ñ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ—é QR-—Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é
‚úî –∑—Ä–æ–±–∏—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—é —Ä—É—Ö—É –ø–æ QR

–•–æ—á–µ—à?
